"use strict";!function(a){_.extend(a.Application.prototype,{navigate:function(a,b){b=b||{},Backbone.history.navigate(a,b)},getCurrentRoute:function(){var a=Backbone.history.fragment;return _.isEmpty(a)?null:a},startHistory:function(){var a=!1;Backbone.history&&(window.history&&window.history.pushState||(a=!0),Backbone.history.start({pushState:"pushState"in window.history,silent:a}))},register:function(a,b){this._registry=this._registry||{},this._registry[b]=a},unregister:function(a,b){return delete this._registry[b]},resetRegistry:function(){var a,b,c,d,e=this.getRegistrySize();for(b in this._registry)c=this._registry[b],c.region.close(),this.DEBUG&&(d=this.getRegistrySize(),a="There were "+e+"controllers in the registry, there are now "+d,d>0?console.warn(a,this._registry):console.log(a))},getRegistrySize:function(){return _.size(this._registry)}})}(Marionette),window.MineSweeper=function(a,b){var c,d;return d={},c=new b.Application,c.addRegions({MainRegion:".minesweeper",GameRegion:".game"}),c.addInitializer(function(){this.module("GameApp").start()}),c.reqres.setHandler("default:region",function(){return c.MainRegion}),c.commands.setHandler("register:instance",function(a,b){c.register(a,b)}),c.commands.setHandler("unregister:instance",function(a,b){c.unregister(a,b)}),c.DEBUG=!1,c}(Backbone,Marionette),window.MineSweeper.start(),window.MineSweeper.module("Controllers",function(a,b,c,d,e,f){a.Base=d.Controller.extend({constructor:function(a){null==a&&(a={}),this.region=a.region||b.request("default:region"),this._instance_id=f.uniqueId("controller"),b.execute("register:instance",this,this._instance_id),d.Controller.constructor.apply(this,arguments)},destroy:function(){return b.execute("unregister:instance",this,this._instance_id),d.Controller.destroy.apply(this,arguments),this},show:function(a,b){return null==b&&(b={}),f.defaults(b,{region:this.region}),this._setMainView(a),this._manageView(a,b),this},resetMainView:function(a){return this._removeMainView(),a&&this._setMainView(a),this},getInstanceID:function(){return this._instance_id},_setMainView:function(a){return this._mainView?void 0:(this._mainView=a,this.listenTo(a,"close",this.close),this)},_manageView:function(a,b){return b.region.show(a),this},_removeMainView:function(){return this.stopListening(this._mainView),delete this._mainView,this}})}),window.MineSweeper.module("Helpers",function(a){a.Board={tilePositionInArray:function(a,b,c){return a*b+c}}}),window.MineSweeper.module("Entities",function(a,b,c,d,e,f){var g,h={easy:{width:8,height:8},medium:{width:16,height:16},hard:{width:30,height:16}};a.Tile=c.Model.extend({initialize:function(){console.log(this)}}),a.Tiles=c.Collection.extend({Model:a.Tile,initialize:function(b,c){var b=[],d=0,e=2*h[c.difficulty];for(d;e-1>d;d++)b.push(new a.Tile({}));this.reset(b,f.extend({silent:!0},c))},placeMines:function(){},setDanger:function(){},getNeighbors:function(){}}),g={getBoard:function(b){var c;return f.defaults(b,{difficulty:"easy",mines:{easy:10,medium:40,hard:99}}),b.width&&b.height?b.difficulty="custom":(null==b.mines[b.difficulty]&&(b.difficulty="easy"),b.mines=b.mines[b.difficulty]),c=new a.Tiles([],b)}},b.reqres.setHandler("board:tiles",function(a){return a=a||{},g.getBoard(a)})}),window.MineSweeper.module("GameApp",function(a,b){var c,d;c={start:function(){return console.log("here"),new a.Board.Controller({region:b.GameRegion})}},a.on("start",function(){d=c.start()})}),window.MineSweeper.module("GameApp.Board",function(a,b){a.Controller=b.Controllers.Base.extend({initialize:function(){var a=b.request("board:tiles");console.log(a)}})});